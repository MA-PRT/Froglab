<%# Ticket pictures carrousel %>
<div id="show-container" class="d-flex flex-column">

  <!-- Carousel Section -->
  <div class="row g-0 flex-grow-1">
    <div class="col-12">
      <div id="carouselExampleIndicators" class="carousel slide h-100">
        <div class="carousel-indicators">
          <% if @ticket.photo.any? %>
            <%# <% @ticket.photo.each_with_index do |_, index| %>
              <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="<%= index %>" class="<%= 'active' if index == 0 %>" aria-current="<%= 'true' if index == 0 %>" aria-label="Slide <%= index + 1 %>"></button>
            <%# <% end %>
          <% else %>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
          <% end %>
        </div>

        <div class="carousel-inner h-100">
          <% if @ticket.photo.any? %>
            <%# <% @ticket.photo.each_with_index do |photo, index| %>
              <div class="carousel-item <%= 'active' if index == 0 %> h-100">
                <%= cl_image_tag photo.key, crop: "lfill", class: "d-block w-100 h-100", alt: "Ticket Image" %>
              </div>
            <%# <% end %>
          <% else %>
            <div class="carousel-item active h-100">
              <img src="https://upload.wikimedia.org/wikipedia/commons/1/14/No_Image_Available.jpg" class="d-block w-100 h-100" alt="No Image Available">
            </div>
          <% end %>
        </div>

        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>

        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
    </div>
  </div>
</div>

<div class="container">
  <%# Ticket informations %>
  <div class="card-body mt-4 mb-4">
    <%# title & category && Content %>
    <h3 class="ticket-show-h-font"><strong><%= @ticket.category %> : <%= @ticket.title %></strong></h3>
  </div>

  <%# Priority point%>
  <div class="mt-2 mb-2 d-flex justify-content-between align-items-center">
  <!-- Priority Text -->
  <p class="ticket-show-p-font mb-0">
    Prioritée :
    <span style="color: <%= progress_point(@ticket.priority)[:color] %>">
      <%= @ticket.priority.humanize %>
    </span>
  </p>

  <!-- Progress Point -->
  <span class="progress-point"
    style="background-color: <%= progress_point(@ticket.priority)[:color] %>;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      display: inline-block;">
  </span>
  </div>

  <%# Status %>
  <div class="mt-3 mb-2 ticket-show-p-font">
    <p><strong>Statut :</strong> <%= @ticket.status.capitalize %></p>
  </div>

  <%# Creation date / Update date %>
  <div class="ticket-show-p-font">
    <% if @ticket.created_at == @ticket.updated_at %>
      <p><strong>Créé le :</strong> <%= @ticket.created_at %></p>
    <% else %>
      <p><strong>Créé le :</strong> <%= @ticket.created_at %></p>
      <p><strong>Derniere modification :</strong> <%= @ticket.updated_at.to_s %></p>
    <% end %>
  </div>

  <%# Utilisateur %>
  <p class="ticket-show-p-font"><strong>Utilisateur :</strong> <%= @ticket.user.first_name %> <%= @ticket.user.last_name %></p>

  <%# Content %>
  <div class="card-body ticket-show-p-font">
    <p><%= @ticket.content %></p>
  </div>



  <%# Actions %>
<div>
  <br>
  <h5 class="mb-4"><strong>Actions à mettre en place :</strong></h5>
  <% @ticket.actions.each do |action| %>
    <div class="card mt-2 mb-2 card-show-ticket">
      <div class="card-body">
        <h6 class="ticket-show-h-font"><strong><%= action.title.capitalize %></strong></h6>

        <p class="mt-3 mb-0">Attribué à : <%= action.user.first_name %> <%= action.user.last_name %><%=  %></p>

        <div class="d-flex justify-content-between align-items-center ticket-show-p-font mt-2">
          <p class="mb-0">Date butoir : <%= action.due_date %></p>
          <% if action.status == "ongoing" %>
            <span class="card-tkt-show-ongoing rounded-pill"><%= action.status.capitalize %></span>
          <% elsif action.status == "solved" %>
            <span class="card-tkt-show-solved rounded-pill"><%= action.status.capitalize %></span>
          <% end %>
        </div>

        <p class="mt-2"><%= action.content %></p>
      </div>
    </div>
  <% end %>
</div>
